<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>ZenZone - AI Therapy Companion</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your safe space for mental health support and guidance">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f2ff 50%, #f8faff 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.8) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 119, 198, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .chat-container {
            width: 100%;
            max-width: 900px;
            height: 700px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .chat-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 24px;
            text-align: center;
            position: relative;
            border-radius: 24px 24px 0 0;
            overflow: hidden;
        }

        .chat-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            50% { transform: translate(-50%, -50%) rotate(180deg); }
        }

        .status-indicator {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 12px;
            height: 12px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-indicator.disconnected {
            background: #f44336;
        }

        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
            100% { opacity: 1; transform: scale(1); }
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            position: relative;
            z-index: 2;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            animation: logoGlow 3s ease-in-out infinite;
        }

        @keyframes logoGlow {
            0%, 100% { 
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 0 0 0 rgba(255, 255, 255, 0.4);
            }
            50% { 
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1), 0 0 20px 10px rgba(255, 255, 255, 0.2);
            }
        }

        .logo-icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .header-content h1 {
            font-size: 36px;
            font-weight: 300;
            margin: 0;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
        }

        .header-content p {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 400;
            margin: 0;
            position: relative;
            z-index: 2;
        }

        .connection-status {
            font-size: 12px;
            margin-top: 8px;
            opacity: 0.8;
        }

        .chat-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            animation: messageSlide 0.3s ease-out;
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 16px 20px;
            border-radius: 20px;
            word-wrap: break-word;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .message.bot .message-content {
            background: white;
            border: 1px solid #e2e8f0;
            border-bottom-left-radius: 6px;
            margin-left: 12px;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-bottom-right-radius: 6px;
            margin-right: 12px;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
            flex-shrink: 0;
        }

        .message.bot .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message.user .message-avatar {
            background: #e2e8f0;
            color: #64748b;
        }

        .message-text {
            font-size: 15px;
            line-height: 1.5;
            margin-bottom: 4px;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
        }

        .typing-indicator {
            display: none;
            align-items: center;
            margin-bottom: 20px;
        }

        .typing-indicator.show {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
            margin-left: 12px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #94a3b8;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }

        .chat-input-container {
            padding: 24px;
            background: white;
            border-top: 1px solid #e2e8f0;
        }

        .input-wrapper {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .chat-input:focus {
            border-color: #4facfe;
            background: white;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .send-button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
        }

        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(79, 172, 254, 0.4);
        }

        .send-button:active {
            transform: scale(0.95);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .welcome-message {
            text-align: center;
            color: #64748b;
            font-style: italic;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }

        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .chat-container {
                height: 100vh;
                border-radius: 0;
                max-width: 100%;
            }

            .chat-header {
                border-radius: 0;
                padding: 20px;
            }

            .message-content {
                max-width: 85%;
            }

            .logo-container {
                margin-bottom: 12px;
            }

            .logo-icon {
                width: 50px;
                height: 50px;
                margin-right: 12px;
            }

            .logo-icon svg {
                width: 28px;
                height: 28px;
            }

            .header-content h1 {
                font-size: 28px;
            }

            .header-content p {
                font-size: 14px;
            }
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <!-- Header -->
        <div class="chat-header">
            <div class="status-indicator" id="statusIndicator"></div>
            <div class="header-content">
                <div class="logo-container">
                    <div class="logo-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1" stroke="currentColor" stroke-width="1.5" opacity="0.5"/>
                        </svg>
                    </div>
                    <h1>ZenZone</h1>
                </div>
                <p>Your AI Therapy Companion</p>
                <div class="connection-status" id="connectionStatus">
                    Connecting to AI...
                </div>
            </div>
        </div>

        <!-- Messages -->
        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">
                Welcome to ZenZone! I'm here to provide a safe space for you to express your thoughts and feelings. How are you doing today?
            </div>
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator" id="typingIndicator">
            <div class="message-avatar">Z</div>
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <!-- Input -->
        <div class="chat-input-container">
            <div class="input-wrapper">
                <input 
                    type="text" 
                    id="inputMessage" 
                    class="chat-input" 
                    placeholder="Share what's on your mind..." 
                    autocomplete="off"
                />
                <button id="sendBtn" class="send-button">
                    <i class="fa-solid fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE_URL = 'http://localhost:8000';
        
        // DOM Elements
        const chatMessages = document.getElementById('chatMessages');
        const inputMessage = document.getElementById('inputMessage');
        const sendBtn = document.getElementById('sendBtn');
        const typingIndicator = document.getElementById('typingIndicator');
        const statusIndicator = document.getElementById('statusIndicator');
        const connectionStatus = document.getElementById('connectionStatus');

        // State
        let isConnected = false;
        let messageCount = 0;

        // Enhanced therapy responses with better emotional intelligence
        const fallbackResponses = [
            "I hear you, and I want you to know that your feelings are completely valid. It takes real courage to share what you're going through. Can you tell me more about what's been weighing on your mind?",
            
            "It sounds like you're navigating through some really challenging emotions right now. Remember, it's absolutely okay to not be okay sometimes - that's part of being human. What would help you feel more supported or understood in this moment?",
            
            "I appreciate you trusting me with this. Opening up about difficult feelings takes incredible strength, and I want you to know that you're safe here. How long have you been carrying these feelings?",
            
            "What you're describing sounds incredibly difficult, and I want you to know that your pain is real and important. Have you found any strategies or activities that have brought you even small moments of relief in the past?",
            
            "I can sense how much this is affecting you, and I want you to know that your feelings matter. What would feel most helpful right now - would you like to explore these emotions together, or would you prefer to focus on finding some comfort?",
            
            "Thank you for being so open with me. It's so important to acknowledge and honor our emotions rather than pushing them away. What do you think might be one small, gentle step you could take toward feeling a little better?",
            
            "I'm here with you in this moment, and I want you to know that you don't have to face this alone. Sometimes simply expressing what we're feeling can be incredibly healing. What else would you like to share?",
            
            "Your vulnerability and honesty are truly admirable. It's clear that this situation means a lot to you, and your feelings are completely understandable. How can I best support you right now?",
            
            "I want you to know that you're not alone in this experience. Many people go through similar challenges, and it doesn't make your feelings any less valid. What would be most helpful for you to hear or explore today?",
            
            "I can hear the resilience in your words, even when things feel overwhelming. That inner strength is something to acknowledge and honor. What brings you moments of peace or hope, even if they're small?",
            
            "Your emotions are telling you something important about what you need right now. Instead of fighting them, what if we gently explore what they might be trying to communicate to you?",
            
            "It's okay to feel overwhelmed, confused, or even angry about what you're experiencing. These are all normal human responses. What would it feel like to give yourself permission to feel exactly what you're feeling?",
            
            "I notice you're being really hard on yourself about this situation. What would you say to a dear friend who was going through exactly what you're experiencing? Sometimes we need to extend ourselves the same compassion we'd give others.",
            
            "Your feelings are like weather - they come and go, and they don't define who you are. Right now, you're in a storm, but storms always pass. What helps you remember that this feeling is temporary?",
            
            "It sounds like you're carrying a lot right now. Sometimes we need to set down some of that emotional weight, even if just for a moment. What would it feel like to share some of that burden with me?"
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            testConnection();
            addWelcomeMessage();
        });

        // Test backend connection
        async function testConnection() {
            try {
                const response = await fetch(`${API_BASE_URL}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: 'test connection' })
                });
                
                if (response.ok) {
                    isConnected = true;
                    statusIndicator.classList.remove('disconnected');
                    connectionStatus.textContent = 'Connected to AI';
                } else {
                    throw new Error('Connection failed');
                }
            } catch (error) {
                console.error('Backend connection failed:', error);
                isConnected = false;
                statusIndicator.classList.add('disconnected');
                connectionStatus.textContent = 'Using offline mode';
            }
        }

        // Add welcome message
        function addWelcomeMessage() {
            setTimeout(() => {
                addMessage("Hello and welcome to ZenZone. I'm here to provide a safe, judgment-free space where you can share what's on your heart and mind. Whether you're feeling overwhelmed, anxious, sad, or just need someone to listen - I'm here for you. What would you like to talk about today?", false);
            }, 1000);
        }

        // Add message to chat
        function addMessage(text, isUser) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = isUser ? 'U' : 'Z';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            
            const messageText = document.createElement('div');
            messageText.className = 'message-text';
            messageText.textContent = text;
            
            const messageTime = document.createElement('div');
            messageTime.className = 'message-time';
            messageTime.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            messageContent.appendChild(messageText);
            messageContent.appendChild(messageTime);
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Show typing indicator
        function showTypingIndicator() {
            typingIndicator.classList.add('show');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Hide typing indicator
        function hideTypingIndicator() {
            typingIndicator.classList.remove('show');
        }

        // Get contextually appropriate response
        function getContextualResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Anxiety and stress responses
            if (message.includes('anxious') || message.includes('anxiety') || message.includes('worried') || message.includes('nervous')) {
                return [
                    "I can hear the anxiety in your words, and I want you to know that what you're feeling is completely understandable. Anxiety can feel overwhelming, but you're not alone in this. What specific thoughts or situations are making you feel most anxious right now?",
                    "It sounds like anxiety is really affecting you right now. Remember, anxiety is your body's way of trying to protect you, even if it doesn't feel helpful. What grounding techniques have worked for you in the past?",
                    "I understand how exhausting anxiety can be. Sometimes just naming what we're feeling can help take some of its power away. What would it feel like to describe the physical sensations you're experiencing?"
                ];
            }
            
            // Depression and sadness responses
            if (message.includes('sad') || message.includes('depressed') || message.includes('down') || message.includes('hopeless')) {
                return [
                    "I can sense the heaviness you're carrying, and I want you to know that your feelings are valid and important. Depression can make everything feel overwhelming, but you're showing incredible strength by reaching out. What's been the hardest part of your day?",
                    "It sounds like you're going through a really difficult time, and I want you to know that it's okay to not be okay. Sometimes depression can make us feel isolated, but you're not alone. What small thing brought you even a moment of comfort recently?",
                    "I hear the pain in your words, and I want you to know that your feelings matter. Depression can make everything feel hopeless, but reaching out like this shows that part of you still believes in hope. What would it feel like to share what's weighing on your heart?"
                ];
            }
            
            // Anger and frustration responses
            if (message.includes('angry') || message.includes('frustrated') || message.includes('mad') || message.includes('irritated')) {
                return [
                    "I can feel the frustration and anger in your message, and those are completely valid emotions. Sometimes anger is trying to tell us something important about our boundaries or needs. What do you think your anger might be trying to communicate?",
                    "It sounds like you're dealing with a lot of frustration right now. Anger can be a powerful emotion, and it's okay to feel it. What would it feel like to explore what's underneath this anger?",
                    "I hear your anger, and I want you to know that it's okay to feel this way. Sometimes we need to feel angry before we can feel anything else. What would help you feel heard and validated right now?"
                ];
            }
            
            // Loneliness responses
            if (message.includes('lonely') || message.includes('alone') || message.includes('isolated') || message.includes('disconnected')) {
                return [
                    "I can hear the loneliness in your words, and I want you to know that feeling alone can be one of the most painful human experiences. You're reaching out right now, which shows incredible courage. What would connection feel like for you?",
                    "It sounds like you're feeling really isolated right now, and that can be so difficult. Sometimes loneliness can make us feel invisible, but I see you and I hear you. What would it feel like to share what's making you feel most alone?",
                    "I understand how overwhelming loneliness can feel. It's like being in a room full of people but feeling completely unseen. You're not invisible to me. What would help you feel more connected right now?"
                ];
            }
            
            // Grief and loss responses
            if (message.includes('grief') || message.includes('loss') || message.includes('died') || message.includes('passed') || message.includes('miss')) {
                return [
                    "I can feel the weight of your loss in your words, and I want you to know that grief is one of the most profound human experiences. There's no right or wrong way to grieve, and your feelings are completely valid. What would it feel like to share what you're missing most?",
                    "It sounds like you're carrying a deep loss, and I want you to know that your grief matters. Grief can feel like an ocean of emotions, and it's okay to feel overwhelmed by it. What would it feel like to honor what you've lost?",
                    "I hear the pain of your loss, and I want you to know that it's okay to not be okay when we're grieving. Grief is love with nowhere to go, and it's one of the most human things we can experience. What would it feel like to share what you're holding onto?"
                ];
            }
            
            // Self-doubt and self-criticism responses
            if (message.includes('stupid') || message.includes('worthless') || message.includes('failure') || message.includes('not good enough')) {
                return [
                    "I can hear how harshly you're speaking to yourself, and I want you to know that you deserve so much more compassion than this. What would you say to a dear friend who was saying these things about themselves? Sometimes we need to extend ourselves the same kindness we'd give others.",
                    "It sounds like your inner critic is being really loud right now, and I want you to know that those harsh thoughts don't define who you are. You're showing incredible strength by being here and sharing this. What would it feel like to challenge that critical voice?",
                    "I hear the self-doubt in your words, and I want you to know that you are so much more than your perceived failures. Every person who has ever accomplished anything has felt exactly like this. What would it feel like to acknowledge your courage for being here?"
                ];
            }
            
            // Return random response if no specific context matches
            return fallbackResponses;
        }

        // Get bot response
        async function getBotResponse(userMessage) {
            if (!isConnected) {
                // Use contextually appropriate responses
                const contextualResponses = getContextualResponse(userMessage);
                return contextualResponses[Math.floor(Math.random() * contextualResponses.length)];
            }

            try {
                const response = await fetch(`${API_BASE_URL}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ message: userMessage })
                });

                if (!response.ok) {
                    throw new Error('Failed to get response from backend');
                }

                const data = await response.json();
                return data.reply;
            } catch (error) {
                console.error('Error getting bot response:', error);
                // Use contextually appropriate fallback responses
                const contextualResponses = getContextualResponse(userMessage);
                return contextualResponses[Math.floor(Math.random() * contextualResponses.length)];
            }
        }

        // Send message
        async function sendMessage() {
            const message = inputMessage.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, true);
            inputMessage.value = '';
            
            // Disable input
            inputMessage.disabled = true;
            sendBtn.disabled = true;
            
            // Show typing indicator
            showTypingIndicator();

            try {
                // Get bot response
                const botResponse = await getBotResponse(message);
                
                // Hide typing indicator
                hideTypingIndicator();
                
                // Add bot response
                addMessage(botResponse, false);
            } catch (error) {
                console.error('Error sending message:', error);
                hideTypingIndicator();
                addMessage("I'm sorry, I'm having trouble processing your message right now. Please try again.", false);
            } finally {
                // Re-enable input
                inputMessage.disabled = false;
                sendBtn.disabled = false;
                inputMessage.focus();
            }
        }

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        
        inputMessage.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Focus input on load
        inputMessage.focus();
    </script>
</body>
</html>